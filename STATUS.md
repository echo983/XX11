# 项目状态与计划

## 当前状态 (里程碑：显示部分闭环 & 视觉反馈环已跑通)
- **核心架构**：完成了“离屏渲染 -> 多模态评估 -> 自动修正”的 Visual Feedback Loop。
- **异构模型协作**：
    - **生成器 (Generator)**：使用 `gpt-5.2` 处理复杂逻辑和初始布局规划。
    - **评估器 (Critic)**：使用 `gpt-5-mini-2025-08-07` 进行高速、低成本的视觉校审（重叠检测、边距检查）。
- **技术突破**：
    - **Structured Outputs**：全面启用 JSON Schema 严格模式，确保 100% 格式准确。
    - **Prompt Caching**：支持 24h 扩展缓存（gpt-5.2）和基础缓存，显著降低迭代延迟。
    - **离屏渲染**：实现了不依赖 X11 的位图渲染引擎，生成 JPG 草稿供 LLM “审阅”。
- **工程化**：
    - 提示词外置（`system`, `generate`, `evaluate` 分离）。
    - 完善的 DEBUG 模式（支持 Token 监控、迭代过程存档、rejection_reason 记录）。

## 现状偏离与差距
- **交互性能**：虽然有缓存，但视觉迭代过程（最多 4 次）仍有一定总时延。
- **本地状态**：尚未实现 hover/pressed 的本地即时反馈，用户点击后仍需等待一轮迭代。
- **事件节流**：高频点击可能导致请求堆积。

## 下一步计划
1. **实现本地 UI 响应 (Local Interaction)**：在本地处理按钮点击的瞬间变色（Pressed 态），提升手感。
2. **优化迭代决策**：微调评估提示词，让 mini 模型更具“实用主义”，在 UI 可用时尽快定稿。
3. **增加 Loading 视觉反馈**：在迭代过程中，在本地显示简单的加载状态，避免界面无响应。

## 进度日志
- 2026-01-06：完成视觉反馈环（Visual Feedback Loop），LLM 现在可以“看到”自己画的东西。
- 2026-01-06：引入 `gpt-5-mini` 作为评估器，实现异构模型协作。
- 2026-01-06：启用 Structured Outputs (json_schema) 严格模式。
- 2026-01-06：开启 Prompt Caching 优化，支持 24h 扩展保留。
- 2026-01-06：增加 DEBUG 存档系统，记录迭代理由和 Token 消耗。